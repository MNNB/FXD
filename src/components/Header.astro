---
import Logo from './Logo.astro';
---

<header class="header">
  <div class="logo">
    <a href="/" aria-label="Home">
      <Logo src="/logo.svg" alt="My Logo" />
    </a>
    <p class="construction">WEBSITE UNDER CONSTRUCTION!</p>
  </div>

  <!-- Burger button -->
  <button id="burger-button" aria-label="Menu" aria-expanded="false" class="burger-button" type="button">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g class="feather feather-menu">
        <line x1="3" y1="12" x2="21" y2="12" stroke="currentColor" stroke-width="2" class="stroke-shape"/> <!-- Middle line -->
        <line x1="3" y1="6" x2="21" y2="6" stroke="currentColor" stroke-width="2" class="stroke-shape"/>   <!-- Top line -->
        <line x1="3" y1="18" x2="21" y2="18" stroke="currentColor" stroke-width="2" class="stroke-shape"/> <!-- Bottom line -->
      </g>
    </svg>
  </button>

  <!-- Desktop navigation -->
  <nav class="nav-links">
    <a href="#approach">APPROACH</a>
    <a href="#experience">EXPERIENCE</a>
    <a href="#about">ABOUT</a>
    <!-- <a href="#blog">BLOG</a> -->
    <svg id="scroll-icon" width="2em" height="2em" viewBox="18266 -2949 32 32" xmlns="http://www.w3.org/2000/svg" fill="none">
      <g>
        <g>
          <g class="fills">
            <path d="M18286.211,-2947.316L18277.789,-2947.316L18277.789,-2949.000L18286.211,-2949.000M18286.211,-2917.000L18277.789,-2917.000L18277.789,-2918.684L18286.211,-2918.684M18267.684,-2937.211L18267.684,-2928.789L18266.000,-2928.789L18266.000,-2937.211L18267.684,-2937.211ZM18269.368,-2941.421L18269.368,-2937.211L18267.684,-2937.211L18267.684,-2941.421L18269.368,-2941.421ZM18271.053,-2943.105L18271.053,-2941.421L18269.368,-2941.421L18269.368,-2943.105L18270.211,-2943.105M18271.895,-2922.053L18273.579,-2922.053L18273.579,-2920.368L18271.895,-2920.368L18271.895,-2921.211M18271.895,-2944.789L18271.895,-2945.632L18273.579,-2945.632L18273.579,-2943.947L18271.895,-2943.947M18270.211,-2922.895L18269.368,-2922.895L18269.368,-2924.579L18271.053,-2924.579L18271.053,-2922.895M18271.895,-2944.789L18271.895,-2943.947L18271.895,-2943.105L18271.053,-2943.105L18270.211,-2943.105L18270.211,-2944.789L18271.895,-2944.789ZM18270.211,-2922.895L18271.053,-2922.895L18271.895,-2922.895L18271.895,-2922.053L18271.895,-2921.211L18270.211,-2921.211L18270.211,-2922.895ZM18269.368,-2928.789L18269.368,-2924.579L18267.684,-2924.579L18267.684,-2928.789L18269.368,-2928.789ZM18277.789,-2945.632L18273.579,-2945.632L18273.579,-2947.316L18277.789,-2947.316L18277.789,-2945.632ZM18277.789,-2918.684L18273.579,-2918.684L18273.579,-2920.368L18277.789,-2920.368L18277.789,-2918.684ZM18273.579,-2920.368L18273.579,-2920.368ZL18273.579,-2920.368ZM18286.211,-2918.684L18286.211,-2918.684ZM18298.000,-2937.211L18298.000,-2937.211ZM18277.789,-2918.684L18286.211,-2918.684L18286.211,-2917.000L18277.789,-2917.000M18277.789,-2949.000L18286.211,-2949.000L18286.211,-2947.316L18277.789,-2947.316M18296.316,-2928.789L18296.316,-2937.211L18298.000,-2937.211L18298.000,-2928.789L18296.316,-2928.789ZM18294.632,-2924.579L18294.632,-2928.789L18296.316,-2928.789L18296.316,-2924.579L18294.632,-2924.579ZM18292.947,-2922.895L18292.947,-2924.579L18294.632,-2924.579L18294.632,-2922.895L18293.789,-2922.895M18292.105,-2943.947L18290.421,-2943.947L18290.421,-2945.632L18292.105,-2945.632L18292.105,-2944.789M18292.105,-2921.211L18292.105,-2920.368L18290.421,-2920.368L18290.421,-2922.053L18292.105,-2922.053M18293.789,-2943.105L18294.632,-2943.105L18294.632,-2941.421L18292.947,-2941.421L18292.947,-2943.105M18292.105,-2921.211L18292.105,-2922.053L18292.105,-2922.895L18292.947,-2922.895L18293.789,-2922.895L18293.789,-2921.211L18292.105,-2921.211ZM18293.789,-2943.105L18292.947,-2943.105L18292.105,-2943.105L18292.105,-2943.947L18292.105,-2944.789L18293.789,-2944.789L18293.789,-2943.105ZM18294.632,-2937.211L18294.632,-2941.421L18296.316,-2941.421L18296.316,-2937.211L18294.632,-2937.211ZM18286.211,-2920.368L18290.421,-2920.368L18290.421,-2918.684L18286.211,-2918.684L18286.211,-2920.368ZM18286.211,-2947.316L18290.421,-2947.316L18290.421,-2945.632L18286.211,-2945.632L18286.211,-2947.316ZM18290.421,-2945.632L18290.421,-2945.632ZL18290.421,-2945.632ZM18277.789,-2947.316L18277.789,-2947.316ZM18266.000,-2928.789L18266.000,-2928.789ZM18273.579,-2947.703L18290.421,-2947.703L18290.421,-2918.297L18273.579,-2918.297L18273.579,-2947.703ZM18296.316,-2941.649L18296.316,-2924.351L18267.684,-2924.351L18267.684,-2941.649L18296.316,-2941.649ZM18271.053,-2944.243L18273.579,-2944.243L18273.579,-2941.649L18271.053,-2941.649L18271.053,-2944.243ZM18271.053,-2924.351L18273.579,-2924.351L18273.579,-2921.757L18271.053,-2921.757L18271.053,-2924.351ZM18290.421,-2944.243L18292.947,-2944.243L18292.947,-2941.649L18290.421,-2941.649L18290.421,-2944.243ZM18290.421,-2924.351L18292.947,-2924.351L18292.947,-2921.757L18290.421,-2921.757L18290.421,-2924.351Z" fill="currentColor"/>
          </g>
        </g>
        <g id="dot-group">
          <rect x="18280.3" y="-2946.4" width="3.4" height="3.4" fill="#fff"/>
        </g>
      </g>
    </svg>
  </nav>

  <!-- Overlay menu -->
  <div class="nav-overlay" id="nav-overlay" aria-hidden="true">
    <nav class="nav-links">
      <a href="#approach">APPROACH</a>
      <a href="#experience">EXPERIENCE</a>
      <!-- <a href="#blog">BLOG</a> -->
      <a href="#about">ABOUT</a>
    </nav>
  </div>

  <script>
    // Scroll icon rotation
    const scrollIcon = document.getElementById('scroll-icon');
    const dotGroup = scrollIcon?.querySelector('#dot-group') as SVGGElement | null;

    function updateDotRotation() {
      if (!dotGroup) return;
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const scrollPercent = docHeight > 0 ? scrollTop / docHeight : 0;
      const angle = scrollPercent * 360;
      dotGroup.setAttribute('transform', `rotate(${angle} 18282 -2933)`);
    }

    if (scrollIcon && dotGroup) {
        updateDotRotation(); // Initial call
        window.addEventListener('scroll', updateDotRotation);
        window.addEventListener('resize', updateDotRotation);
    }

    // Burger menu toggle
    const burgerButton = document.getElementById('burger-button') as HTMLButtonElement | null;
    const navOverlay = document.getElementById('nav-overlay') as HTMLElement | null;
    
    if (burgerButton && navOverlay) {
      burgerButton.addEventListener('click', (e) => {
        e.preventDefault(); 
        const isMenuOpen = document.body.classList.toggle('menu-open');
        burgerButton.setAttribute('aria-expanded', isMenuOpen.toString());
        navOverlay.setAttribute('aria-hidden', (!isMenuOpen).toString());
      });
    }
    
    // Close overlay menu on link click
    const overlayNavLinks = navOverlay?.querySelectorAll('.nav-links a');
    overlayNavLinks?.forEach(link => {
        link.addEventListener('click', () => {
            document.body.classList.remove('menu-open');
            burgerButton?.setAttribute('aria-expanded', 'false');
            navOverlay?.setAttribute('aria-hidden', 'true');
        });
    });

  </script>
</header>

<style>
  .header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    padding: var(--space-sm) 4em; /* Large padding for desktop */
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--background);
    z-index: var(--z-header);
    transition: background-color 0.3s ease; 
  }

  .logo { 
    display: flex;
    justify-content: flex-start;
    align-items: center;
    text-align: left;
    width: auto;
    z-index: var(--z-logo); 
    color: var(--logo-color); 
    transition: color 0.3s ease;
  }

  .logo a :global(svg) { 
    height: 1.2rem;
    width: auto;
    fill: currentColor; 
  }

  .construction {
    font-family: var(--font-mono);
    font-size: var(--font-size-sm);
    color: var(--color-gray);
    margin-left: var(--space-md);
  }

  /* Desktop Nav links */
  .header > nav.nav-links { 
    display: flex;
    align-items: center;
    gap: var(--space-md);
    font-family: var(--font-mono);
    font-size: var(--font-size-sm);
    text-transform: uppercase;
  }
  
  .header > nav.nav-links a {
    color: var(--logo-color); 
    transition: color var(--transition-base);
  }
  .header > nav.nav-links a:hover {
    color: var(--color-light-gray);
  }
  
  #scroll-icon {
    color: var(--logo-color); 
    transition: color var(--transition-base);
    fill: currentColor; 
  }
  #scroll-icon #dot-group rect {
      fill: var(--color-white); 
  }

  /* Burger Menu Button */
  .burger-button {
    display: none; 
    top: var(--space-sm); 
    right: 1rem; /* Adjusted for mobile padding */
    background: transparent;
    border: none;
    cursor: pointer;
    z-index: var(--z-burger); 
    padding: var(--space-xs);
    color: var(--logo-color); 
    transition: color 0.3s ease;
  }

  .burger-button svg {
    width: 24px; 
    height: 24px;
    display: block; 
  }

  .burger-button svg .stroke-shape {
    stroke-width: 2; 
    stroke: currentColor; 
    transition: transform 0.3s ease, opacity 0.3s ease;
    transform-origin: center; 
  }
  
  /* When menu is open, these styles are applied via :global as body class changes */
  :global(body.menu-open) .header {
    --logo-color: var(--logo-color-menu-open); /* This makes .logo and .nav-links a inherit new color */
  }

  :global(body.menu-open) .burger-button {
      color: var(--logo-color-menu-open); /* This changes currentColor for SVG strokes to white */
  }

  :global(body.menu-open) .burger-button svg .stroke-shape:nth-child(1) { /* Middle line */
    opacity: 0;
    transform: scaleX(0); 
  }

  :global(body.menu-open) .burger-button svg .stroke-shape:nth-child(2) { /* Top line */
    transform: translateY(6px) rotate(45deg); 
  }

  :global(body.menu-open) .burger-button svg .stroke-shape:nth-child(3) { /* Bottom line */
    transform: translateY(-6px) rotate(-45deg); 
  }

  /* Overlay Menu */
  .nav-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: var(--color-black);
    color: var(--color-white); 
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--transition-base);
    z-index: var(--z-overlay); 
  }

  .nav-overlay nav.nav-links { 
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-md); 
    font-family: var(--font-mono);
    font-size: var(--font-size-md); 
    text-transform: uppercase;
  }
  .nav-overlay nav.nav-links a {
    color: var(--color-white);
  }
  .nav-overlay nav.nav-links a:hover {
    color: var(--color-light-gray);
  }
  
  :global(body.menu-open) .nav-overlay {
    opacity: 1;
    pointer-events: auto;
  }
  
  :global(body.menu-open) #scroll-icon { 
    display: none;
  }

  /* Responsive Styles for Header */
  @media (max-width: 768px) {
    .header {
      padding: var(--space-sm) 1rem; 
      flex-direction: row; 
      justify-content: space-between; 
      align-items: center; 
    }

    .header .logo {
      margin-bottom: 0; 
    }
    
    .construction {
        display: none; 
    }

    .header > nav.nav-links { /* Desktop nav links */
      display: none !important; 
    }

    .burger-button {
      display: block; 
      /* top: var(--space-sm); // Re-affirm if needed, but should be fine from base .burger-button */
      /* right: 1rem; // Re-affirm if needed */
    }
    
    .nav-overlay nav.nav-links {
      gap: var(--space-lg); 
    }
  }
</style>
